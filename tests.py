'''
Created on Aug 12, 2018

@author: jgenson
'''
import unittest

from gametable import GameTable


class GameTableTests(unittest.TestCase):
    FIXED_COSTS = 30
    BASE_SALES = 100
    P1_EXPECTED_PAYOFFS = {(32, 54): 640, (56, 51): 1300, (46, 42): 960, (53, 53): 2300, (33, 55): 960, (57, 50): 810, (47, 35): -340, (54, 58): 3360, (34, 52): 1120, (58, 41): -1960, (32, 44): 440, (31, 44): 230, (55, 35): -2500, (35, 41): 800, (33, 41): 540, (36, 34): 480, (34, 46): 880, (41, 57): 2860, (37, 35): 560, (44, 34): 0, (48, 37): -180, (38, 40): 960, (45, 35): 0, (49, 32): -1330, (39, 45): 1440, (44, 56): 3080, (50, 39): -200, (49, 58): 3610, (56, 58): 3120, (46, 45): 1440, (51, 34): -1470, (47, 40): 510, (52, 37): -1100, (58, 48): 0, (32, 35): 260, (56, 32): -3640, (55, 56): 2750, (35, 46): 1050, (33, 34): 330, (40, 35): 500, (36, 41): 900, (34, 41): 680, (41, 34): 330, (31, 51): 300, (37, 44): 1190, (35, 52): 1350, (42, 57): 3000, (38, 35): 560, (36, 55): 1740, (43, 52): 2470, (39, 42): 1170, (37, 54): 1890, (44, 55): 2940, (48, 50): 2160, (45, 54): 2850, (51, 31): -2100, (49, 51): 2280, (41, 36): 550, (50, 56): 3200, (38, 31): 240, (46, 52): 2560, (51, 43): 420, (47, 49): 2040, (54, 52): 1920, (52, 44): 440, (32, 58): 720, (56, 39): -1820, (55, 49): 1000, (53, 33): -2300, (57, 38): -2430, (40, 42): 1200, (54, 46): 480, (34, 32): 320, (58, 37): -3080, (41, 43): 1320, (31, 56): 350, (55, 47): 500, (42, 32): 0, (40, 48): 1800, (43, 45): 1560, (39, 35): 540, (44, 46): 1680, (48, 41): 540, (45, 47): 1800, (49, 52): 2470, (39, 57): 2520, (50, 51): 2200, (51, 48): 1470, (52, 43): 220, (32, 49): 540, (56, 46): 0, (46, 33): -480, (53, 42): -230, (57, 47): 0, (47, 36): -170, (54, 33): -2640, (58, 44): -1120, (41, 44): 1430, (31, 33): 120, (55, 36): -2250, (35, 34): 450, (42, 43): 1320, (40, 55): 2500, (36, 37): 660, (43, 34): 130, (41, 54): 2530, (37, 56): 2030, (44, 37): 420, (42, 53): 2520, (48, 32): -1080, (38, 55): 2160, (45, 40): 750, (43, 56): 2990, (49, 45): 1140, (39, 54): 2250, (50, 42): 400, (51, 57): 3360, (52, 50): 1760, (56, 53): 1820, (46, 40): 640, (53, 51): 1840, (33, 53): 900, (57, 48): 270, (47, 45): 1360, (54, 56): 2880, (34, 50): 1040, (58, 55): 1960, (32, 46): 480, (31, 46): 250, (35, 43): 900, (33, 47): 720, (36, 44): 1080, (34, 44): 800, (31, 52): 310, (37, 33): 420, (35, 49): 1200, (48, 39): 180, (38, 46): 1440, (45, 33): -300, (43, 49): 2080, (49, 38): -190, (39, 47): 1620, (44, 58): 3360, (50, 37): -600, (43, 40): 910, (49, 56): 3230, (52, 57): 3300, (46, 51): 2400, (51, 36): -1050, (57, 57): 2700, (40, 31): 100, (54, 51): 1680, (52, 39): -660, (32, 37): 300, (56, 34): -3120, (55, 58): 3250, (53, 38): -1150, (33, 32): 270, (57, 35): -3240, (40, 37): 700, (36, 43): 1020, (34, 39): 600, (41, 32): 110, (37, 42): 1050, (35, 54): 1450, (42, 39): 840, (38, 33): 400, (36, 49): 1380, (43, 54): 2730, (39, 36): 630, (37, 52): 1750, (44, 49): 2100, (48, 52): 2520, (36, 31): 300, (49, 49): 1900, (50, 54): 2800, (46, 58): 3520, (51, 45): 840, (47, 51): 2380, (52, 46): 880, (58, 57): 2520, (56, 41): -1300, (55, 51): 1500, (53, 47): 920, (33, 57): 1020, (57, 36): -2970, (40, 44): 1400, (54, 44): 0, (58, 35): -3640, (41, 41): 1100, (31, 58): 370, (55, 41): -1000, (42, 46): 1680, (40, 50): 2000, (36, 56): 1800, (43, 47): 1820, (41, 51): 2200, (44, 40): 840, (48, 43): 900, (38, 50): 1760, (45, 45): 1500, (49, 42): 570, (50, 49): 1800, (52, 54): 2640, (51, 50): 1890, (47, 56): 3230, (52, 53): 2420, (32, 51): 580, (56, 48): 520, (46, 39): 480, (53, 40): -690, (33, 50): 810, (57, 45): -540, (47, 38): 170, (54, 39): -1200, (34, 57): 1320, (58, 42): -1680, (32, 41): 380, (31, 35): 140, (55, 38): -1750, (35, 36): 550, (42, 41): 1080, (40, 57): 2700, (42, 31): -120, (36, 39): 780, (43, 36): 390, (41, 52): 2310, (37, 38): 770, (44, 39): 700, (42, 51): 2280, (48, 34): -720, (38, 53): 2000, (45, 38): 450, (43, 58): 3250, (49, 35): -760, (39, 48): 1710, (50, 40): 0, (48, 56): 3240, (45, 52): 2550, (49, 31): -1520, (56, 55): 2340, (46, 46): 1600, (53, 49): 1380, (51, 33): -1680, (57, 54): 1890, (47, 47): 1700, (34, 48): 960, (58, 53): 1400, (32, 32): 200, (31, 40): 190, (35, 45): 1000, (33, 45): 660, (40, 32): 200, (36, 46): 1200, (34, 42): 720, (58, 31): -4760, (31, 54): 330, (37, 47): 1400, (35, 51): 1300, (42, 58): 3120, (38, 44): 1280, (36, 52): 1560, (43, 51): 2340, (49, 36): -570, (39, 41): 1080, (44, 52): 2520, (50, 35): -1000, (45, 57): 3300, (54, 31): -3120, (46, 49): 2080, (53, 58): 3450, (51, 38): -630, (47, 52): 2550, (54, 49): 1200, (52, 33): -1980, (32, 39): 340, (56, 36): -2600, (55, 52): 1750, (53, 36): -1610, (33, 38): 450, (57, 33): -3780, (40, 39): 900, (54, 43): -240, (34, 37): 520, (58, 38): -2800, (41, 38): 770, (37, 40): 910, (35, 56): 1550, (42, 37): 600, (38, 39): 880, (36, 51): 1500, (34, 31): 280, (39, 38): 810, (37, 50): 1610, (44, 51): 2380, (48, 54): 2880, (38, 57): 2320, (45, 50): 2250, (49, 55): 3040, (50, 52): 2400, (46, 56): 3200, (51, 47): 1260, (52, 40): -440, (56, 43): -780, (46, 34): -320, (53, 45): 460, (57, 42): -1350, (40, 46): 1600, (54, 34): -2400, (58, 33): -4200, (41, 47): 1760, (31, 36): 150, (55, 43): -500, (35, 33): 400, (42, 44): 1440, (40, 52): 2200, (36, 58): 1920, (43, 33): 0, (41, 49): 1980, (44, 42): 1120, (42, 54): 2640, (48, 45): 1260, (38, 48): 1600, (45, 43): 1200, (49, 40): 190, (39, 53): 2160, (50, 47): 1400, (51, 52): 2310, (47, 58): 3570, (52, 55): 2860, (32, 53): 620, (56, 50): 1040, (46, 37): 160, (53, 54): 2530, (33, 48): 750, (57, 51): 1080, (47, 32): -850, (54, 37): -1680, (34, 55): 1240, (58, 40): -2240, (32, 43): 420, (31, 45): 240, (55, 32): -3250, (35, 38): 650, (33, 42): 570, (36, 33): 420, (43, 38): 650, (41, 58): 2970, (37, 36): 630, (44, 33): -140, (42, 49): 2040, (48, 36): -360, (38, 43): 1200, (45, 36): 150, (49, 33): -1140, (39, 50): 1890, (50, 38): -400, (48, 58): 3600, (56, 57): 2860, (46, 44): 1280, (51, 35): -1260, (57, 52): 1350, (47, 41): 680, (52, 36): -1320, (58, 51): 840, (32, 34): 240, (31, 42): 210, (55, 57): 3000, (35, 47): 1100, (33, 35): 360, (40, 34): 400, (36, 40): 840, (43, 31): -260, (41, 35): 440, (31, 48): 270, (37, 45): 1260, (35, 53): 1400, (42, 56): 2880, (38, 34): 480, (36, 54): 1680, (43, 53): 2600, (39, 43): 1260, (37, 55): 1960, (44, 54): 2800, (50, 33): -1400, (48, 49): 1980, (45, 55): 3000, (57, 39): -2160, (52, 31): -2420, (39, 31): 180, (46, 55): 3040, (53, 56): 2990, (51, 40): -210, (47, 54): 2890, (54, 55): 2640, (52, 35): -1540, (58, 58): 2800, (32, 57): 700, (56, 38): -2080, (55, 54): 2250, (53, 34): -2070, (33, 36): 390, (47, 31): -1020, (40, 41): 1100, (54, 41): -720, (34, 35): 440, (58, 36): -3360, (32, 31): 180, (31, 57): 360, (55, 44): -250, (35, 58): 1650, (42, 35): 360, (38, 37): 720, (43, 42): 1170, (39, 32): 270, (37, 48): 1470, (44, 45): 1540, (48, 40): 360, (45, 48): 1950, (49, 53): 2660, (44, 50): 2240, (50, 50): 2000, (51, 49): 1680, (52, 42): 0, (32, 48): 520, (56, 45): -260, (46, 32): -640, (53, 43): 0, (57, 40): -1890, (47, 37): 0, (54, 32): -2880, (34, 58): 1360, (58, 47): -280, (41, 45): 1540, (31, 38): 170, (55, 37): -2000, (35, 35): 500, (42, 42): 1200, (40, 54): 2400, (36, 36): 600, (43, 35): 260, (41, 55): 2640, (37, 57): 2100, (44, 36): 280, (42, 52): 2400, (48, 47): 1620, (38, 54): 2080, (45, 41): 900, (43, 57): 3120, (49, 46): 1330, (39, 55): 2340, (50, 45): 1000, (51, 54): 2730, (52, 49): 1540, (32, 55): 660, (56, 52): 1560, (46, 43): 1120, (53, 52): 2070, (33, 54): 930, (57, 49): 540, (47, 34): -510, (34, 53): 1160, (58, 54): 1680, (32, 45): 460, (31, 47): 260, (55, 34): -2750, (35, 40): 750, (33, 40): 510, (36, 35): 540, (34, 47): 920, (41, 56): 2750, (31, 53): 320, (37, 34): 490, (44, 35): 140, (48, 38): 0, (38, 41): 1040, (45, 34): -150, (49, 39): 0, (39, 44): 1350, (44, 57): 3220, (50, 36): -800, (49, 57): 3420, (55, 31): -3500, (52, 56): 3080, (46, 50): 2240, (51, 37): -840, (57, 58): 2970, (47, 43): 1020, (54, 50): 1440, (52, 38): -880, (58, 49): 280, (32, 36): 280, (56, 33): -3380, (33, 31): 240, (33, 33): 300, (40, 36): 600, (36, 42): 960, (34, 38): 560, (41, 33): 220, (31, 50): 290, (37, 43): 1120, (35, 55): 1500, (42, 38): 720, (38, 32): 320, (36, 48): 1320, (43, 55): 2860, (39, 37): 720, (37, 53): 1820, (44, 48): 1960, (48, 51): 2340, (38, 58): 2400, (45, 53): 2700, (49, 50): 2090, (37, 31): 280, (50, 57): 3400, (46, 53): 2720, (51, 42): 210, (47, 48): 1870, (54, 53): 2160, (52, 45): 660, (58, 56): 2240, (56, 40): -1560, (46, 31): -800, (53, 32): -2530, (33, 58): 1050, (57, 37): -2700, (40, 43): 1300, (54, 47): 720, (34, 33): 360, (58, 34): -3920, (41, 42): 1210, (55, 46): 250, (42, 33): 120, (40, 49): 1900, (43, 44): 1430, (39, 34): 450, (44, 47): 1820, (48, 42): 720, (45, 46): 1650, (49, 43): 760, (39, 56): 2430, (50, 48): 1600, (51, 51): 2100, (47, 57): 3400, (52, 52): 2200, (32, 50): 560, (56, 47): 260, (46, 38): 320, (53, 41): -460, (33, 51): 840, (57, 46): -270, (47, 39): 340, (54, 38): -1440, (34, 56): 1280, (58, 45): -840, (32, 40): 360, (31, 32): 110, (55, 39): -1500, (35, 37): 600, (42, 40): 960, (40, 56): 2600, (36, 38): 720, (43, 37): 520, (41, 53): 2420, (37, 39): 840, (44, 38): 560, (42, 50): 2160, (48, 33): -900, (38, 52): 1920, (45, 39): 600, (49, 44): 950, (39, 49): 1800, (50, 43): 600, (41, 31): 0, (51, 56): 3150, (52, 51): 1980, (50, 31): -1800, (56, 54): 2080, (46, 41): 800, (53, 50): 1610, (33, 52): 870, (57, 55): 2160, (47, 44): 1190, (54, 57): 3120, (53, 39): -920, (34, 51): 1080, (58, 52): 1120, (32, 47): 500, (31, 41): 200, (35, 42): 850, (33, 46): 690, (36, 45): 1140, (34, 45): 840, (31, 55): 340, (37, 32): 350, (35, 48): 1150, (38, 47): 1520, (45, 32): -450, (43, 48): 1950, (49, 37): -380, (39, 46): 1530, (56, 31): -3900, (50, 34): -1200, (45, 58): 3450, (52, 58): 3520, (46, 48): 1920, (51, 39): -420, (57, 56): 2430, (47, 53): 2720, (54, 48): 960, (52, 32): -2200, (32, 38): 320, (56, 35): -2860, (55, 53): 2000, (53, 37): -1380, (33, 39): 480, (57, 34): -3510, (40, 38): 800, (54, 42): -480, (34, 36): 480, (41, 39): 880, (37, 41): 980, (35, 57): 1600, (42, 36): 480, (38, 38): 800, (36, 50): 1440, (43, 41): 1040, (39, 39): 900, (37, 51): 1680, (35, 31): 300, (48, 53): 2700, (38, 56): 2240, (45, 51): 2400, (49, 48): 1710, (50, 55): 3000, (51, 44): 630, (44, 31): -420, (47, 42): 850, (52, 47): 1100, (31, 31): 100, (55, 50): 1250, (53, 46): 690, (33, 56): 990, (57, 43): -1080, (40, 45): 1500, (54, 45): 240, (58, 32): -4480, (41, 40): 990, (31, 37): 160, (55, 40): -1250, (42, 47): 1800, (40, 51): 2100, (36, 57): 1860, (43, 46): 1690, (41, 50): 2090, (44, 41): 980, (48, 44): 1080, (38, 51): 1840, (45, 44): 1350, (49, 41): 380, (39, 58): 2610, (50, 46): 1200, (34, 40): 640, (51, 53): 2520, (47, 50): 2210, (32, 52): 600, (56, 49): 780, (46, 36): 0, (53, 55): 2760, (33, 49): 780, (57, 44): -810, (47, 33): -680, (54, 36): -1920, (34, 54): 1200, (58, 43): -1400, (32, 42): 400, (31, 34): 130, (55, 33): -3000, (35, 39): 700, (33, 43): 600, (40, 58): 2800, (36, 32): 360, (43, 39): 780, (37, 37): 700, (44, 32): -280, (42, 48): 1920, (48, 35): -540, (38, 42): 1120, (45, 37): 300, (56, 42): -1040, (49, 34): -950, (39, 51): 1980, (50, 41): 200, (48, 57): 3420, (48, 31): -1260, (51, 58): 3570, (56, 56): 2600, (46, 47): 1760, (53, 48): 1150, (51, 32): -1890, (57, 53): 1620, (47, 46): 1530, (34, 49): 1000, (58, 50): 560, (32, 33): 220, (31, 43): 220, (35, 44): 950, (33, 44): 630, (57, 31): -4320, (40, 33): 300, (36, 47): 1260, (34, 43): 760, (31, 49): 280, (37, 46): 1330, (35, 50): 1250, (38, 45): 1360, (36, 53): 1620, (43, 50): 2210, (39, 40): 990, (44, 53): 2660, (50, 32): -1600, (48, 48): 1800, (45, 56): 3150, (50, 58): 3600, (53, 31): -2760, (46, 54): 2880, (53, 57): 3220, (51, 41): 0, (47, 55): 3060, (54, 54): 2400, (52, 34): -1760, (32, 56): 680, (56, 37): -2340, (55, 55): 2500, (53, 35): -1840, (33, 37): 420, (57, 32): -4050, (40, 40): 1000, (54, 40): -960, (34, 34): 400, (58, 39): -2520, (41, 37): 660, (55, 45): 0, (42, 34): 240, (38, 36): 640, (43, 43): 1300, (39, 33): 360, (37, 49): 1540, (44, 44): 1400, (48, 55): 3060, (45, 49): 2100, (49, 54): 2850, (55, 48): 750, (50, 53): 2600, (45, 31): -600, (46, 57): 3360, (51, 46): 1050, (52, 41): -220, (56, 44): -520, (46, 35): -160, (53, 44): 230, (57, 41): -1620, (40, 47): 1700, (54, 35): -2160, (58, 46): -560, (41, 46): 1650, (31, 39): 180, (55, 42): -750, (35, 32): 350, (42, 45): 1560, (40, 53): 2300, (43, 32): -130, (41, 48): 1870, (37, 58): 2170, (44, 43): 1260, (42, 55): 2760, (48, 46): 1440, (38, 49): 1680, (45, 42): 1050, (49, 47): 1520, (39, 52): 2070, (50, 44): 800, (51, 55): 2940, (52, 48): 1320}
    P2_EXPECTED_PAYOFFS = P1_EXPECTED_PAYOFFS
    PRICES = range(31, 59)
    
    @staticmethod
    def calc_payoff(my_price, their_price):
        per_item_profit = my_price - GameTableTests.FIXED_COSTS
        sales = GameTableTests.BASE_SALES + (their_price - my_price) * 10
        total_profit = sales * per_item_profit
        
        return total_profit

    def setUp(self):
        self.game_table = GameTable()
        self.game_table.player1_name = 'Player 1'
        self.game_table.player2_name = 'Player 2'
        self.game_table.calc_player1_payoff = self.calc_payoff
        self.game_table.calc_player2_payoff = self.calc_payoff
        self.game_table.choices = self.PRICES 

    def test_construct(self):
        self.game_table.construct()
        self.assertEqual(self.game_table.player1_payoffs, self.P1_EXPECTED_PAYOFFS)
        self.assertEqual(self.game_table.player2_payoffs, self.P2_EXPECTED_PAYOFFS)
        self.assertTrue(self.game_table.player1_dominants)
        self.assertTrue(self.game_table.player2_dominants)
        
    def test_index(self):
        self.game_table.construct()
        for p1_price in self.PRICES:
            for p2_price in self.PRICES:
                p1_payoff, p2_payoff = self.game_table[p1_price, p2_price]
                self.assertEqual(p1_payoff, self.P1_EXPECTED_PAYOFFS[p1_price, p2_price])
                self.assertEqual(p2_payoff, self.P2_EXPECTED_PAYOFFS[p2_price, p1_price])


if __name__ == "__main__":
    unittest.main()